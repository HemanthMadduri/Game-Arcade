<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Snake Game</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      overflow: hidden;
      background-color: black;
    }
    canvas {
      display: block;
      background-color: #111;
    }
    #overlay {
      position: absolute;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      color: white;
      font-size: 2em;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: rgba(0,0,0,0.7);
      z-index: 999;
    }
    button {
      font-size: 1em;
      padding: 10px 20px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
<div id="overlay">
  <div>ðŸ’€ You died!</div>
  <button onclick="restartGame()">ðŸ”„ Try Again</button>
</div>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const tileSize = 20;
const tilesX = Math.floor(canvas.width / tileSize);
const tilesY = Math.floor(canvas.height / tileSize);

let snake, direction, apple, score, speed, gameOver, overlay;

function init() {
  snake = [{x: 5, y: 5}];
  direction = {x: 1, y: 0};
  score = 0;
  speed = 150;
  gameOver = false;
  overlay = document.getElementById("overlay");
  spawnApple();
  requestAnimationFrame(gameLoop);
}

function spawnApple() {
  apple = {
    x: Math.floor(Math.random() * tilesX),
    y: Math.floor(Math.random() * tilesY)
  };
}

function gameLoop(timestamp) {
  if (gameOver) return;
  setTimeout(() => {
    update();
    draw();
    requestAnimationFrame(gameLoop);
  }, speed);
}

function update() {
  const head = {
    x: (snake[0].x + direction.x + tilesX) % tilesX,
    y: (snake[0].y + direction.y + tilesY) % tilesY
  };

  // Check self-collision
  if (snake.some(segment => segment.x === head.x && segment.y === head.y)) {
    overlay.style.display = "flex";
    gameOver = true;
    return;
  }

  snake.unshift(head);

  if (head.x === apple.x && head.y === apple.y) {
    score++;
    speed = Math.max(50, speed - 5);
    spawnApple();
  } else {
    snake.pop();
  }
}

function draw() {
  ctx.fillStyle = "#111";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Draw snake
  ctx.fillStyle = "lime";
  for (let segment of snake) {
    ctx.fillRect(segment.x * tileSize, segment.y * tileSize, tileSize, tileSize);
  }

  // Draw apple
  ctx.fillStyle = "red";
  ctx.fillRect(apple.x * tileSize, apple.y * tileSize, tileSize, tileSize);

  // Draw score
  ctx.fillStyle = "white";
  ctx.font = "20px sans-serif";
  ctx.fillText("Score: " + score, 10, 30);
}

window.addEventListener("keydown", e => {
  if (e.key === "ArrowUp" && direction.y === 0) direction = {x: 0, y: -1};
  if (e.key === "ArrowDown" && direction.y === 0) direction = {x: 0, y: 1};
  if (e.key === "ArrowLeft" && direction.x === 0) direction = {x: -1, y: 0};
  if (e.key === "ArrowRight" && direction.x === 0) direction = {x: 1, y: 0};
});

function restartGame() {
  overlay.style.display = "none";
  init();
}

init();
</script>
</body>
</html>
