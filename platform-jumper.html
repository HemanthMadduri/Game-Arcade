<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Platform Jumper</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    canvas { background: #87CEEB; display: block; margin: auto; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let keys = {};
let score = 0;

const player = {
  x: 180,
  y: 500,
  width: 30,
  height: 30,
  vx: 0,
  vy: 0,
  speed: 4,
  jumpPower: -12,
  onGround: false,
};

const gravity = 0.5;

const platforms = [
  { x: 100, y: 550, width: 200, height: 10 },
  { x: 50, y: 400, width: 100, height: 10 },
  { x: 250, y: 300, width: 120, height: 10 },
  { x: 150, y: 150, width: 100, height: 10 },
];

function drawPlayer() {
  ctx.fillStyle = 'red';
  ctx.fillRect(player.x, player.y, player.width, player.height);
}

function drawPlatforms() {
  ctx.fillStyle = 'green';
  platforms.forEach(p => {
    ctx.fillRect(p.x, p.y, p.width, p.height);
  });
}

function drawScore() {
  ctx.fillStyle = 'black';
  ctx.font = '20px Arial';
  ctx.fillText("Score: " + Math.floor(score), 10, 30);
}

function updatePlayer() {
  // Keyboard Movement
  if (keys['ArrowLeft'] || keys['a']) player.vx = -player.speed;
  else if (keys['ArrowRight'] || keys['d']) player.vx = player.speed;
  else player.vx = 0;

  // Apply gravity
  player.vy += gravity;
  player.x += player.vx;
  player.y += player.vy;

  // Platform collision
  player.onGround = false;
  platforms.forEach(p => {
    if (
      player.x < p.x + p.width &&
      player.x + player.width > p.x &&
      player.y + player.height < p.y + 10 &&
      player.y + player.height + player.vy >= p.y
    ) {
      player.vy = 0;
      player.y = p.y - player.height;
      player.onGround = true;
    }
  });

  // Prevent going off screen
  if (player.x < 0) player.x = 0;
  if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
  if (player.y > canvas.height) {
    alert("Game Over! Your score: " + Math.floor(score));
    document.location.reload();
  }
}

function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  updatePlayer();
  drawPlatforms();
  drawPlayer();
  drawScore();
  score += 0.1;
  requestAnimationFrame(gameLoop);
}

// Keyboard
document.addEventListener('keydown', (e) => {
  keys[e.key] = true;
  if ((e.key === 'ArrowUp' || e.key === 'w') && player.onGround) {
    player.vy = player.jumpPower;
  }
});
document.addEventListener('keyup', (e) => {
  keys[e.key] = false;
});

// Touch Support
let touchStartX = 0, touchStartY = 0;
let touchEndX = 0, touchEndY = 0;

canvas.addEventListener("touchstart", function(e) {
  const t = e.touches[0];
  touchStartX = t.clientX;
  touchStartY = t.clientY;
}, false);

canvas.addEventListener("touchend", function(e) {
  const dx = touchEndX - touchStartX;
  const dy = touchEndY - touchStartY;
  const absDx = Math.abs(dx);
  const absDy = Math.abs(dy);

  if (absDx > absDy) {
    // Horizontal swipe
    if (dx < 0) {
      player.vx = -player.speed;
    } else {
      player.vx = player.speed;
    }
  } else {
    // Vertical swipe
    if (dy < 0 && player.onGround) {
      // Up swipe = jump
      let swipePower = Math.min(Math.abs(dy) / 10, 20); // max jump power
      player.vy = -swipePower;
    }
  }
}, false);

canvas.addEventListener("touchmove", function(e) {
  const t = e.touches[0];
  touchEndX = t.clientX;
  touchEndY = t.clientY;
}, false);

// Start the game
gameLoop();
</script>
</body>
</html>

    
